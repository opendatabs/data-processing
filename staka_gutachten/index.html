<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vom Kanton in Auftrag gegebene Gutachten</title>

  <style>
    :root{
      /* primary = green */
      --primary-700:#2A713F; /* green-700 */
      --primary-600:#32834A;

      /* from your palette */
      --red-50:#FFF1EF;
      --red-800:#B81600;

      --gray-20:#F8F8F8;
      --gray-100:#EBEBEB;
      --gray-900:#333333;
      --gray-800:#403F3F;

      --blue-700:#146C8B;
      --blue-900:#1E4557;

      --purple-200:#E8DAF4;
    }

    body{
      font-family: Inter, "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: var(--gray-900);
      margin: 0;
      padding: 30px;
      background: #fff;
    }

    /* Center everything */
    .page{
      min-height: calc(100vh - 60px);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Title */
    h1{
      font-size: 36px;
      line-height: 40px;
      font-weight: 700;
      margin: 0 0 20px 0;
      color: var(--primary-700);
      text-align: center;
      max-width: 900px;
    }

    p{ margin: 15px 0; }
    ul{
      margin: 15px 0 0 18px;
      padding-left: 0;
      list-style: disc;
    }

    li{
      margin-left: 0;
      padding-left: 4px;
      padding-bottom: 12px;
    }

    a{ color: var(--blue-900); text-decoration: underline; }
    a:hover{ color: var(--blue-700); }

    /* box component */
    .box{
      position: relative;
      margin: 30px 0;
      border-radius: 10px;
      padding: 20px 30px 20px 20px;
      max-width: 610px;
      width: 100%;
      background: #F2F7F3;
    }

    .box__header{
      display:flex;
      flex-wrap:wrap;
      align-items:baseline;
      margin-right:60px; /* leave room for icon */
      gap: 6px;
    }

    .box__title{
      font-size: 20px;
      line-height: 28px;
      font-weight: 700;
      color: var(--primary-600);
    }

    .box__addon{
      font-size:16px;
      line-height:22px;
      font-weight:500;
      color: var(--gray-900);
    }

    .box__content{
      margin-top: 15px;
      hyphens: auto;
      font-size:16px;
      line-height:22px;
    }

    /* Round “logo” icon */
    .box__icon{
      position: absolute;
      right: 15px;
      top: 15px;
      width: 50px;
      height: 50px;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .box__icon img{
      width: 50px;
      height: 50px;
      max-width: 50px;
      max-height: 50px;
      object-fit: contain;
      display: block;
    }
    /* warning variant */
    .box--warning{
      background: var(--red-50);
    }
    .box--warning .box__title{
      color: var(--red-800);
    }

    /* button.is-action */
    .button{
      border: 1px solid var(--blue-900);
      background: var(--gray-20);
      color: var(--blue-900);
      transition: all 250ms ease-in-out;
      cursor: pointer;
    }
    .button.is-action{
      border-radius: 20px;
      font-size: 14px;
      line-height: 20px;
      padding: 10px 20px;
    }
    .button.is-action:hover{
      background: var(--blue-700);
      border-color: var(--blue-700);
      color: #fff;
    }
    .button.is-action:focus{
      outline: none;
      background: var(--blue-700);
      border-color: var(--blue-700);
      color: #fff;
    }
    .button:disabled{
      background: #E3E3E3;
      border-color: #E3E3E3;
      color: var(--gray-800);
      cursor: not-allowed;
    }

    .row{
      display:flex;
      gap: 15px;
      align-items:center;
      flex-wrap:wrap;
      margin-top: 15px;
    }

    iframe{
      width: min(1100px, 100%);
      height: 80vh;
      border: 1px solid var(--gray-100);
      border-radius: 10px;
      margin-top: 20px;
      display:none;
    }

    code{
      background: var(--gray-20);
      padding: .1rem .3rem;
      border-radius: 6px;
    }

    .muted{ 
      font-size: 12px;
      color:#666; 
    }

    /* hide title after accept */
    .is-hidden{ display:none !important; }
  </style>
</head>

<body>
  <div class="page">

    <h1 id="pageTitle">Vom Kanton in Auftrag gegebene Gutachten</h1>

    <div class="box box--warning" id="gate">
      <div class="box__icon" aria-hidden="true" title="Hinweis">
        <img src="warning.svg" alt="" />
      </div>
      <div class="box__header">
        <div class="box__title">Wichtiger Hinweis - Bedingungen für den Zugriff</div>
      </div>

      <div class="box__content">
        <p>Vor dem Zugriff auf das Gutachten bestätigen Sie bitte:</p>
        <ul>
          <li>Ich habe die <a href="https://data.bs.ch/pages/wasistogd/#nutzung" target="_blank" rel="noopener">Nutzungs- und Rahmenbedingungen von OGD</a> gelesen.</li>
          <li>Die Urheberrechte der Autorinnen und Autoren bleiben gewahrt.</li>
        </ul>

        <div class="row">
          <button class="button is-action" id="open">Akzeptieren & öffnen</button>
        </div>

        <p class="muted" id="fileHint"></p>
      </div>
    </div>

    <iframe id="pdf" title="Gutachten PDF"></iframe>

  </div>

<script>
  const params = new URLSearchParams(location.search);
  const file = params.get("file"); // e.g. "foo.pdf"
  const isSafe = file && /^[a-zA-Z0-9._-]+\.pdf$/i.test(file);

  const titleEl = document.getElementById("pageTitle");
  const btn = document.getElementById("open");
  const hint = document.getElementById("hint");
  const fileHint = document.getElementById("fileHint");
  const gate = document.getElementById("gate");
  const frame = document.getElementById("pdf");

  if (!isSafe) {
    fileHint.innerHTML = 'Kein gültiges PDF angegeben. Erwartet: <code>?file=NAME.pdf</code>';
    btn.disabled = true;
  } else {
    fileHint.textContent = "Datei: " + file;
  }

  const key = "gutachten_accept_v1:" + (file || "unknown");

  function showPdf() {
    // title disappears after accept
    titleEl.classList.add("is-hidden");

    gate.style.display = "none";
    frame.style.display = "block";
    frame.src = file; // relative to this directory
  }

  // already accepted?
  if (isSafe && localStorage.getItem(key) === "yes") showPdf();

  btn.addEventListener("click", () => {
    if (!isSafe) return;
    localStorage.setItem(key, "yes");
    showPdf();
  });
</script>

</body>
</html>
